<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <title><%= work.title %> - å®‰ç§‘é˜…è¯»</title>

  <!-- âœ… SEOä¼˜åŒ– -->
  <meta name="description" content="<%= work.content[0]?.content?.ops?.[0]?.insert?.substring(0, 100).replace(/\n/g, ' ') || work.title %>">
  <meta name="keywords" content="å®‰ç§‘, å°è¯´, åŒäºº, <%= work.title %>, <%= work.author?.username || 'åŒ¿å' %>">
  <meta property="og:title" content="<%= work.title %>">
  <meta property="og:description" content="ä½œè€…ï¼š<%= work.author?.username || 'åŒ¿å' %> | é˜…è¯»é‡ <%= work.views %>">
  <meta property="og:type" content="article">
  <meta property="og:image" content="<%= work.coverImage || 'https://i.ibb.co/QFPHMF8T/Copilot-20250922-174349.png' %>">
  <meta property="og:url" content="https://api.anchorx.ca/read/<%= work._id %>">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Noto Sans SC", "Microsoft YaHei", Arial, sans-serif;
      background: #f8f8f8;
      color: #333;
      max-width: 850px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.8;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    header h1 {
      font-size: 1.8rem;
      margin-bottom: 8px;
      color: #222;
    }

    .meta {
      font-size: 0.9rem;
      color: #666;
    }

    .content-block {
      background: white;
      border-radius: 8px;
      padding: 24px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .content-block img {
      max-width: 100%;
      display: block;
      margin: 10px auto;
      border-radius: 8px;
    }

    footer {
      margin-top: 50px;
      font-size: 0.85rem;
      color: #888;
      text-align: center;
    }
  </style>
</head>

<body>
  <header>
    <h1><%= work.title %></h1>
    <p class="meta">
      âœï¸ ä½œè€…ï¼š<%= work.author?.username || "åŒ¿å" %>ã€€
      â° æ›´æ–°ï¼š<%= new Date(work.updatedAt).toLocaleDateString("zh-Hans") %>ã€€
      ğŸ‘ï¸ é˜…è¯»ï¼š<%= work.views %>ã€€
      â¤ï¸ å–œæ¬¢ï¼š<%= work.likesCount %>
    </p>
  </header>

  <% if (work.coverImage) { %>
    <img src="<%= work.coverImage %>" alt="å°é¢" style="width:100%;max-height:400px;object-fit:cover;border-radius:10px;margin-bottom:30px;">
  <% } %>

  <% if (Array.isArray(work.content)) { %>
    <% work.content.forEach((page, index) => { %>
      <section class="content-block">
        <% if (typeof page.content === 'string') { %>
          <div><%- page.content %></div>
        <% } else if (typeof page.content === 'object' && Array.isArray(page.content.ops)) { %>
          <% const text = page.content.ops.map(op => typeof op.insert === 'string' ? op.insert : '').join(''); %>
          <p><%= text %></p>
        <% } %>
      </section>
    <% }); %>
  <% } else { %>
    <p>æš‚æ— å†…å®¹ã€‚</p>
  <% } %>

  <footer>
    <p>ğŸ“… åˆ›å»ºäº <%= new Date(work.createdAt).toLocaleDateString("zh-Hans") %></p>
    <p>Â© 2025 å®‰ç§‘æ–‡åº“ AnchorX</p>
  </footer>

  <!-- ä¿ç•™åŸæœ¬å‰ç«¯äº¤äº’è„šæœ¬ï¼ˆæ¯”å¦‚è¯„è®ºã€ç¹ç®€è½¬æ¢ç­‰ï¼‰ -->
  <script src="/vendor_assets/js/read-page.js"></script>
</body>
</html>
